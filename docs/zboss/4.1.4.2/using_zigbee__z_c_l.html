<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>Developing with ZBOSS for Zigbee : Zigbee stack API overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="nordic.css" rel="stylesheet" type="text/css" />
<link rel="Shortcut icon" href="./favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%" class="blank">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Nordic Semiconductor" src="logo_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Developing with ZBOSS for Zigbee
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('using_zigbee__z_c_l.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Zigbee stack API overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#ZCL_definitions">Common ZCL terms and definitions</a></li>
<li class="level1"><a href="#zigbee_device_imp">Implementing a Zigbee end product with ZCL</a><ul><li class="level2"><a href="#att_declaration">Declaring attributes</a></li>
<li class="level2"><a href="#cluster_declaration">Declaring cluster</a><ul><li class="level3"><a href="#cluster_declaration_custom">Declaring custom cluster</a></li>
</ul>
</li>
<li class="level2"><a href="#cluster_list_declaration">Declaring cluster list</a></li>
<li class="level2"><a href="#endpoint_dec">Declaring endpoint</a></li>
<li class="level2"><a href="#simple_desc_declaration">Declaring simple descriptor</a></li>
<li class="level2"><a href="#zigbee_device_context_dec">Declaring Zigbee device context</a></li>
<li class="level2"><a href="#zigbee_device_context_mult_ep_dec">Declaring Zigbee device context with multiple endpoints</a></li>
<li class="level2"><a href="#register_zigbee_device">Registering device context</a></li>
<li class="level2"><a href="#process_zcl_cmd">Configuring default ZCL command handler override</a><ul><li class="level3"><a href="#process_zcl_cmd_executing">Executing interception mechanism</a></li>
<li class="level3"><a href="#process_zcl_cmd_implementing">Implementing algorithm for overriding the handling of ZCL commands</a></li>
</ul>
</li>
<li class="level2"><a href="#zigbee_device_callback">Implementing Zigbee device callback</a></li>
<li class="level2"><a href="#zcl_cmds_send">Sending ZCL commands</a></li>
<li class="level2"><a href="#zcl_cmd_parse">Parsing ZCL commands</a></li>
</ul>
</li>
<li class="level1"><a href="#zcl_zigbee_commissioning">Support for Zigbee commissioning</a><ul><li class="level2"><a href="#zcl_zigbee_commissioning_config_seq">Commissioning configuration sequence</a></li>
<li class="level2"><a href="#network_config_general">Network configuration settings (general)</a></li>
<li class="level2"><a href="#network_config_bdb">Network configuration settings (BDB-specific)</a></li>
<li class="level2"><a href="#stack_start_initiation">Stack commissioning start sequence</a></li>
<li class="level2"><a href="#commissioning_event_handling">Zigbee commissioning event handling</a></li>
<li class="level2"><a href="#bdb_commissioning_api">BDB Commissioning API</a></li>
<li class="level2"><a href="#reset_factory_defaults">Resetting to factory defaults</a><ul><li class="level3"><a href="#reset_factory_defaults_ext">Resetting to factory defaults externally</a></li>
<li class="level3"><a href="#reset_to_factory_defaults_via_local_action">Resetting to factory defaults with a local action</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#using_ZCL_security">Security</a><ul><li class="level2"><a href="#security_nwk_security_api">Zigbee network security API</a></li>
<li class="level2"><a href="#security_nwk_code_security_api">Zigbee API for code security installation</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>This page provides an overview of the stack ZCL, commissioning, and security APIs.</p>
<h1><a class="anchor" id="ZCL_definitions"></a>
Common ZCL terms and definitions</h1>
<p>The following table lists terms that are used in the <a href="https://www.zigbee.org/non-menu-pages/zigbee-cluster-library-specification-download ">Zigbee Cluster Library specification</a>. </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Term </th><th class="markdownTableHeadNone">Definition  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Attribute </td><td class="markdownTableBodyNone">A data entity that represents a physical quantity or state. This data is communicated to other devices through commands.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Cluster </td><td class="markdownTableBodyNone">A specification that defines one or more attributes, commands, behaviors, or dependencies. Cluster supports an independent utility or application function.<br  />
<br  />
The term can also be used for the implementation or the instance of the cluster specification on an endpoint.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Device </td><td class="markdownTableBodyNone">A specification that defines a unique device identifier and a set of mandatory and optional clusters to be implemented on a single endpoint.<br  />
<br  />
The term can also be used for the implementation or the instance of the device specification on an endpoint.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Endpoint </td><td class="markdownTableBodyNone">A device instance on a node.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Node </td><td class="markdownTableBodyNone">A testable implementation of a Zigbee application on a single stack with a single network address, and on a single network.  </td></tr>
</table>
<center><b>ZCL specification terms and definitions</b></center><p>The Zigbee application implements a node that handles endpoints. Every endpoint implements a set of clusters. Clusters implement the device functionality, such as attributes to store the state and the commands for various operations.</p>
<p>The ZCL specification is designed to minimize the consumption of flash and RAM by the user application. The application uses the API to declare a Zigbee device and to construct and parse ZCL commands.</p>
<hr  />
<h1><a class="anchor" id="zigbee_device_imp"></a>
Implementing a Zigbee end product with ZCL</h1>
<p>Zigbee devices are characterized by a set of clusters that have mandatory and optional attributes. To save memory, make sure that only the required attributes and clusters are declared.</p>
<p>Application can either use predefined device declaration (for example, IAS Zone device) or define its own set of clusters and endpoints.</p>
<p>At the highest level, the Zigbee end product implementation consists of the following parts:</p><ul>
<li>Declaration of Zigbee device data structures:<ul>
<li><a class="el" href="using_zigbee__z_c_l.html#att_declaration">Declaring attributes</a> for each cluster (attribute lists),</li>
<li><a class="el" href="using_zigbee__z_c_l.html#cluster_declaration">Declaring cluster</a> (or <a class="el" href="using_zigbee__z_c_l.html#cluster_declaration_custom">Declaring custom cluster</a>),</li>
<li><a class="el" href="using_zigbee__z_c_l.html#cluster_list_declaration">Declaring cluster list</a> for a device,</li>
<li><a class="el" href="using_zigbee__z_c_l.html#endpoint_dec">Declaring endpoint</a> (including runtime context).</li>
</ul>
</li>
<li>Zigbee device executable code:<ul>
<li><a class="el" href="using_zigbee__z_c_l.html#register_zigbee_device">Registering device context</a> (including optional implementation of a handler function for custom ZCL packets),</li>
<li><a class="el" href="using_zigbee__z_c_l.html#process_zcl_cmd">Configuring default ZCL command handler override</a>,</li>
<li><a class="el" href="using_zigbee__z_c_l.html#zigbee_device_callback">Implementing Zigbee device callback</a> (optional),</li>
<li><a class="el" href="using_zigbee__z_c_l.html#zcl_cmds_send">Sending ZCL commands</a> and <a class="el" href="using_zigbee__z_c_l.html#zcl_cmd_parse">Parsing ZCL commands</a> according to the application logic.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="att_declaration"></a>
Declaring attributes</h2>
<p>ZCL attributes are described according to the ZCL specification. The library declares attribute lists according to the mandatory attribute sets of the clusters. The ZCL attributes are defined in a form that allows modification.</p>
<dl class="section user"><dt>Naming convention</dt><dd>Each attribute list declaration API has a name corresponding to ZB_ZCL_DECLARE_&lt;CLUSTER_NAME&gt;_CLUSTER_ATTRIB_LIST. The attribute list starts with <code>ZB_ZCL_START_DECLARE_ATTRIB_LIST</code> and ends with ZB_ZCL_FINISH_DECLARE_ATTRIB_LIST. You can add any number of additional attributes between these lines.</dd></dl>
<dl class="section user"><dt>Example 1</dt><dd>The following macro defines the list of attributes for the Door Lock cluster: <div class="fragment"><div class="line"><span class="preprocessor">#define ZB_ZCL_DECLARE_DOOR_LOCK_CLUSTER_ATTRIB_LIST(attr_list,                         \</span></div>
<div class="line"><span class="preprocessor">                                                     lock_state,                        \</span></div>
<div class="line"><span class="preprocessor">                                                     lock_type,                         \</span></div>
<div class="line"><span class="preprocessor">                                                     actuator_enabled)                  \</span></div>
<div class="line"><span class="preprocessor">    ZB_ZCL_START_DECLARE_ATTRIB_LIST(attr_list)                                         \</span></div>
<div class="line"><span class="preprocessor">    ZB_ZCL_SET_ATTR_DESC(ZB_ZCL_ATTR_DOOR_LOCK_LOCK_STATE_ID, (lock_state))             \</span></div>
<div class="line"><span class="preprocessor">    ZB_ZCL_SET_ATTR_DESC(ZB_ZCL_ATTR_DOOR_LOCK_LOCK_TYPE_ID, (lock_type))               \</span></div>
<div class="line"><span class="preprocessor">    ZB_ZCL_SET_ATTR_DESC(ZB_ZCL_ATTR_DOOR_LOCK_ACTUATOR_ENABLED_ID, (actuator_enabled)) \</span></div>
<div class="line"><span class="preprocessor">    ZB_ZCL_FINISH_DECLARE_ATTRIB_LIST</span></div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Example 2</dt><dd>The following code example defines global variables for the attributes and initiates them with the default values. It then declares the list of attributes for the On/Off Switch configuration cluster. <div class="fragment"><div class="line"><a class="code" href="group__base__types.html#gaa82a9657ef11a3947586065cf8066256">zb_uint8_t</a> attr_switch_type = <a class="code" href="group___z_b___z_c_l___o_o_s_c.html#ggae92bb00709be040ba03a01f754ea1f29aa3e98ff8bc1ba98068e1bd8204038039">ZB_ZCL_ON_OFF_SWITCH_CONFIGURATION_SWITCH_TYPE_TOGGLE</a>;</div>
<div class="line"><a class="code" href="group__base__types.html#gaa82a9657ef11a3947586065cf8066256">zb_uint8_t</a> attr_switch_actions = <a class="code" href="group___z_b___z_c_l___o_o_s_c.html#gaac509b1128c5a2fc9cc107f559466329">ZB_ZCL_ON_OFF_SWITCH_CONFIGURATION_SWITCH_ACTIONS_DEFAULT_VALUE</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="group___z_b___z_c_l___o_o_s_c.html#ga005d9f73f4306d2327672c5fa992075b">ZB_ZCL_DECLARE_ON_OFF_SWITCH_CONFIGURATION_ATTRIB_LIST</a>(switch_cfg_attr_list,</div>
<div class="line">                                                       &amp;attr_switch_type,</div>
<div class="line">                                                       &amp;attr_switch_actions);</div>
</div><!-- fragment --> The <code>ZB_ZCL_DECLARE_ON_OFF_SWITCH_CONFIGURATION_ATTRIB_LIST</code> macro is defined in the <code>zb_zcl_on_off_switch.h</code> file. This cluster supports two attributes: <code>switch_type</code> and <code>switch_actions</code>.</dd></dl>
<h2><a class="anchor" id="cluster_declaration"></a>
Declaring cluster</h2>
<p>The SDK provides more than 30 implemented Zigbee clusters that are ready for the user application.</p>
<p>To use a cluster, the application must declare it as part of the Zigbee device that is being implemented. Each cluster description is associated with a Zigbee device and includes the following data:</p><ul>
<li>Cluster ID (according to the Zigbee Cluster Library specification);</li>
<li>Attribute list (according to <a class="el" href="using_zigbee__z_c_l.html#att_declaration">Declaring attributes</a> &ndash; the cluster declaration keeps both a pointer to the list of attributes and an attribute count);</li>
<li>Cluster role (according to the Zigbee Cluster Library specification);</li>
<li>Manufacturer specific code.</li>
</ul>
<p>The cluster description data is stored using <a class="el" href="group__zb__zcl__common__types.html#ga2bcbd450785f151f71c0a0f4a449efa2">zb_zcl_cluster_desc_t</a> type. The SDK provides several APIs to fill in cluster descriptors while creating the cluster list declaration.</p>
<h3><a class="anchor" id="cluster_declaration_custom"></a>
Declaring custom cluster</h3>
<p>When a non-standard cluster is required, implement it in the following manner:</p><ol type="1">
<li>Create the cluster headers with the name corresponding to the following template: <code>zb_zcl_&lt;cluster_name&gt;.h</code></li>
<li>In the cluster headers, declare the required attributes with read, write, or reporting functionality.</li>
<li>Create the cluster implementation with the name corresponding to the following template: <code>zb_zcl_&lt;cluster_name&gt;.c</code></li>
<li>In the created cluster implementation .c file, implement parsers for the required commands.</li>
<li>Add the new cluster to the device declaration header.</li>
<li>If you need specific commands in the new cluster, register proper functions using <a class="el" href="group__zb__zcl__common__types.html#ga97b747ed8f4ec2ca08e80097d3e5cc35">zb_zcl_add_cluster_handlers</a>.</li>
<li>In the created cluster implementation .c file, handle these custom commands. The commands are processed when the application layer returns ZB_TRUE.</li>
</ol>
<h2><a class="anchor" id="cluster_list_declaration"></a>
Declaring cluster list</h2>
<p>All the available Zigbee device functions are defined by a set of supported clusters. The cluster list is an array of the <a class="el" href="group__zb__zcl__common__types.html#ga2bcbd450785f151f71c0a0f4a449efa2">zb_zcl_cluster_desc_t</a> type. For standard Zigbee devices, the source code contains a set of declaration APIs for cluster lists. A cluster list can be modified by adding or removing clusters.</p>
<dl class="section note"><dt>Note</dt><dd>All cluster attributes in the cluster list must be declared. Missing or placing NULL instead of any attribute from the list causes errors during compilation or leads to inconsistent application behavior.</dd></dl>
<dl class="section user"><dt>Naming convention</dt><dd>Each cluster list declaration API has a name corresponding to ZB_HA_DECLARE_&lt;DEVICE_NAME&gt;_CLUSTER_LIST.</dd></dl>
<dl class="section user"><dt>Example</dt><dd>List declaration for a dimmable light (a standard Zigbee device): <div class="fragment"><div class="line"><a class="code" href="group___z_b___h_a___d_e_f_i_n_e___d_e_v_i_c_e___d_i_m_m_a_b_l_e___l_i_g_h_t.html#gab9021e9a2dd5ff2462d7b96bffd7dc5f">ZB_HA_DECLARE_DIMMABLE_LIGHT_CLUSTER_LIST</a>(cluster_list_name, basic_attr_list, identify_attr_list, groups_attr_list, scenes_attr_list, on_off_attr_list, level_control_attr_list)</div>
</div><!-- fragment --> </dd></dl>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="group___z_b___h_a___d_e_f_i_n_e___d_e_v_i_c_e___d_i_m_m_a_b_l_e___l_i_g_h_t.html#gab9021e9a2dd5ff2462d7b96bffd7dc5f">ZB_HA_DECLARE_DIMMABLE_LIGHT_CLUSTER_LIST()</a> is defined in <code>zb_ha_dimmable_light.h</code>. Whenever the dimmable light utilizes Basic, Identify, Groups, Scenes, On/Off, and Level Control clusters in a server role, the device takes attribute lists for all of them.</dd></dl>
<h2><a class="anchor" id="endpoint_dec"></a>
Declaring endpoint</h2>
<p>An endpoint or a set of endpoints fully describes a Zigbee device. The endpoint declaration in the user application finalizes the logical description of the Zigbee device. To implement ZCL features, each Zigbee device must have at least one endpoint declared besides the built-in one (with <code>ep_id</code> parameter value set to 0). This declared endpoint will be stored in the <a class="el" href="group__af__data__service.html#ga1a5bd5cdddd0ac1b2ebe99e50f0e769a">zb_af_endpoint_desc_t</a> type endpoint list.</p>
<p>Each endpoint description includes the following data:</p><ul>
<li>Endpoint ID,</li>
<li>Profile ID,</li>
<li>Cluster list,</li>
<li>Simple descriptor,</li>
<li>Internal runtime data.</li>
</ul>
<p>The endpoint description data is stored using the type <a class="el" href="group__af__data__service.html#ga1a5bd5cdddd0ac1b2ebe99e50f0e769a">zb_af_endpoint_desc_t</a>. The SDK provides several APIs to fill in endpoint descriptors while performing a Zigbee device declaration for each supported Zigbee device. Additionally, the API declares a simple descriptor. The endpoint list declaration API is provided in the source code and can be modified depending on the application.</p>
<dl class="section user"><dt>Naming convention</dt><dd>Each endpoint declaration API has a name corresponding to ZB_HA_DECLARE_&lt;DEVICE_NAME&gt;_EP.</dd></dl>
<dl class="section user"><dt>Example</dt><dd>Endpoint declaration for a dimmable light (a standard Zigbee device): <div class="fragment"><div class="line"><a class="code" href="group___z_b___h_a___d_e_f_i_n_e___d_e_v_i_c_e___d_i_m_m_a_b_l_e___l_i_g_h_t.html#ga43db3ee88e06f7c79b73f9401561da43">ZB_HA_DECLARE_DIMMABLE_LIGHT_EP</a>(ep_name, ep_id, cluster_list)</div>
</div><!-- fragment --></dd></dl>
<h2><a class="anchor" id="simple_desc_declaration"></a>
Declaring simple descriptor</h2>
<p>The simple descriptor contains specific information for each endpoint contained in a node. It is mandatory for each endpoint present in the node.</p>
<p>The API declares the simple descriptor for each standard Zigbee device and embeds the related calls into the endpoint declaration APIs. However, if modifications to the standard device are requested, the simple descriptor declaration is provided in the source code and you can modify it according to the application needs.</p>
<p>Technically speaking, the simple descriptor is a variable of the type <a class="el" href="group__af__data__service.html#gaa5666842e8fcb73dab20564f8e52f53c">ZB_AF_SIMPLE_DESC_TYPE(in_clust_count, out_clust_count)</a>. A pointer to this variable is stored in the endpoint descriptor. This macro is used to create a full type name at compilation time. This is because the simple descriptor contains a list of in and out (client/server) clusters, and the list size varies for different devices. To minimize the RAM usage, the specified values of in and out clusters are used to declare an array of a size required to store all cluster IDs.</p>
<p>There is a base type declared for the simple descriptor: <code><a class="el" href="group__af__data__service.html#gaa5666842e8fcb73dab20564f8e52f53c">ZB_AF_SIMPLE_DESC_TYPE(1, 1)</a></code>. This type is used to cast all the user-specific simple descriptor types at runtime.</p>
<dl class="section user"><dt>Naming convention</dt><dd>Each simple descriptor declaration API has a name corresponding to ZB_HA_DECLARE_&lt;DEVICE_NAME&gt;_SIMPLE_DESC.</dd></dl>
<dl class="section user"><dt>APIs</dt><dd>The APIs for managing simple descriptor types are the following:<ul>
<li>New type declaration: <a class="el" href="group__af__data__service.html#ga831fb2c589a6831ea0231b5c18e4267b">ZB_DECLARE_SIMPLE_DESC(in_clust_count, out_clust_count)</a></li>
<li>Reference to the type name: <a class="el" href="group__af__data__service.html#gaa5666842e8fcb73dab20564f8e52f53c">ZB_AF_SIMPLE_DESC_TYPE(in_clust_count, out_clust_count)</a></li>
</ul>
</dd></dl>
<h2><a class="anchor" id="zigbee_device_context_dec"></a>
Declaring Zigbee device context</h2>
<p>The Zigbee device context aggregates the list of endpoints and runtime data, for example storage for reporting configuration information and Level Control context information. The application is responsible for providing enough storage for reporting and Level Control context data for all the endpoints that it declares. For standard Zigbee devices, it is the API that declares device context together with storage for all the context data.</p>
<dl class="section user"><dt>Naming convention</dt><dd>Each device declaration API has a name corresponding to ZB_HA_DECLARE_&lt;DEVICE_NAME&gt;_CTX.</dd></dl>
<dl class="section user"><dt>APIs</dt><dd>To modify the existing device context declaration or define a new one, use the API call <a class="el" href="group__af__management__service.html#gaab7adde4a9c39072e37631629788776d">ZBOSS_DECLARE_DEVICE_CTX_1_EP(device_ctx_name, ep_name)</a>.</dd></dl>
<h2><a class="anchor" id="zigbee_device_context_mult_ep_dec"></a>
Declaring Zigbee device context with multiple endpoints</h2>
<p>The stack provides the ability to declare one or multiple endpoints for a device.</p>
<p>To declare a multiple endpoint device, the application must call <code>ZBOSS_DECLARE_DEVICE_CTX_&lt;N&gt;_EP</code>, where N is the number of endpoints.</p>
<p>The stack provides the default macros for declaring not more than 4 endpoints for a device. If the application requires a higher number of endpoints, use one of the following elements for declaring the desired device context:</p><ul>
<li><a class="el" href="group__af__management__service.html#gab5d7bc9c56f835b915a8075168083fbb">ZBOSS_DECLARE_DEVICE_CTX_3_EP(device_ctx_name, ep1_name, ep2_name, ep3_name)</a>,</li>
<li><a class="el" href="group__af__management__service.html#ga3d8345835674be21c1b22c5e19aae8c2">ZBOSS_DECLARE_DEVICE_CTX_4_EP(device_ctx_name, ep1_name, ep2_name, ep3_name, ep4_name)</a></li>
</ul>
<p>For instance, <a class="el" href="group__af__management__service.html#ga07eb277f632dff91c8cd5226d5bd9d45">ZBOSS_DECLARE_DEVICE_CTX_2_EP(device_ctx_name, ep1_name, ep2_name)</a> declares the device context with two different endpoint descriptors (ep1_name, ep2_name).</p>
<p>For more information on how to declare endpoint descriptors, refer to the section <a class="el" href="using_zigbee__z_c_l.html#endpoint_dec">Declaring endpoint</a>.</p>
<h2><a class="anchor" id="register_zigbee_device"></a>
Registering device context</h2>
<p>When the declaration procedures are finished, the device context must be registered with a call to <a class="el" href="group__af__management__service.html#ga2ba409e0ae3e25032b673a5f85859a45">ZB_AF_REGISTER_DEVICE_CTX</a>. As part of this call, two callbacks can be registered in the application:</p><ul>
<li>ZCL packet handler &ndash; registered with a call to <a class="el" href="group__af__management__service.html#ga549b0a17bcf5d9788c23882d68298142">ZB_AF_SET_ENDPOINT_HANDLER()</a>.<ul>
<li>The handler allows for application-specific handling of the incoming ZCL messages. For more details, see <a class="el" href="using_zigbee__z_c_l.html#process_zcl_cmd">Configuring default ZCL command handler override</a>.</li>
</ul>
</li>
<li>Zigbee device callback &ndash; registered with a call to <a class="el" href="group__af__management__service.html#ga9df506ef2a06d883d7d39f545b55da8d">ZB_ZCL_REGISTER_DEVICE_CB()</a>.<ul>
<li>The Zigbee device callback is a multipurpose callback used as a common entry point to a user-specific handler implementation for different cases. It covers attribute changes, device identification, actions specific to poll control, OTA firmware upgrade, and others. For more details, see <a class="el" href="using_zigbee__z_c_l.html#zigbee_device_callback">Implementing Zigbee device callback</a>.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="process_zcl_cmd"></a>
Configuring default ZCL command handler override</h2>
<p>The stack implements the default handling of all the ZCL commands for all supported clusters, but is also provides a mechanism to override the default settings by intercepting the default ZCL command processing and implementing a custom, application-specific command handling.</p>
<h3><a class="anchor" id="process_zcl_cmd_executing"></a>
Executing interception mechanism</h3>
<p>To execute this mechanism, the ZCL packet handler callback must be first implemented and registered by the application (see <a class="el" href="using_zigbee__z_c_l.html#register_zigbee_device">Registering device context</a>). After the ZCL packet handler is registered, it is called for each new incoming ZCL command. This happens before the default ZCL handler is called.</p><ul>
<li>If the application-specific ZCL packet handler returns <a class="el" href="group__base__types.html#gae0f2d2d69ee138eedec4460449f84431">ZB_FALSE</a>, the packet is not processed by the application and the default ZCL handling is applied.</li>
<li>If the application does handle the packet and no default processing is needed, the packet handler returns <a class="el" href="group__base__types.html#ga31ddce10b950c4f30d546945beabdcbc">ZB_TRUE</a>. This means that the packet is processed.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>If the application started parsing packets and modified a packet (header or tail bytes have been cut or byte order has been inverted), it must finalize the packet processing. Otherwise, the default handler can fail.</li>
<li>If the application handles the received packet, it is responsible for sending a response (if needed) and managing the memory buffer that stores the original ZCL packet.</li>
</ul>
</dd></dl>
<p>The most common commands processed by the application are responses to the requests sent, including Read attribute response, Write attribute response, and Configure reporting response.</p>
<dl class="section user"><dt>APIs</dt><dd>The SDK comes with API macros for handling the received packets, for example <a class="el" href="group__read__attr__command.html#ga4e54806a8a1d53d772726790a6eba3b3">ZB_ZCL_GENERAL_GET_NEXT_READ_ATTR_RES()</a>, <a class="el" href="group__write__attr__cmd.html#ga7ef76219a4135cca06bb504d2ef71b17">ZB_ZCL_GET_NEXT_WRITE_ATTR_RES()</a>, and <a class="el" href="group__cfg__reporting__cmd.html#ga1eca7dc3b94a9ccd505d663f89d1f405">ZB_ZCL_GENERAL_GET_NEXT_CONFIGURE_REPORTING_RES()</a>. Each packet-parsing API call can modify the ZCL packet it is parsing "in place". For more details on the parsing API, see <a class="el" href="group___z_b___z_c_l___c_o_m_m_a_n_d_s.html">ZCL commands shared by all clusters</a> in the <a class="el" href="group__zcl__api.html">ZCL API</a> documentation. <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Macro </th><th class="markdownTableHeadNone">Parameters </th><th class="markdownTableHeadNone">Return value </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__af__management__service.html#ga549b0a17bcf5d9788c23882d68298142">ZB_AF_SET_ENDPOINT_HANDLER(endpoint, handler)</a> </td><td class="markdownTableBodyNone"><code>endpoint</code> &ndash; Endpoint number.<br  />
<code>handler</code> &ndash; Pointer to a function of the type <a class="el" href="group__af__management__service.html#ga4d58cf3d0e6c159c9c63bc2e9d88887c">zb_device_handler_t</a>. </td><td class="markdownTableBodyNone">None. </td><td class="markdownTableBodyNone">Register ZCL packet handler for the specific endpoint.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group__af__management__service.html#ga4d58cf3d0e6c159c9c63bc2e9d88887c">zb_device_handler_t</a>(<a class="el" href="group__base__types.html#gaa82a9657ef11a3947586065cf8066256">zb_uint8_t</a> param) </td><td class="markdownTableBodyNone"><a class="el" href="group__base__types.html#gaa82a9657ef11a3947586065cf8066256">zb_uint8_t</a> <code>param</code> &ndash; ID of the buffer with the incoming ZCL command. </td><td class="markdownTableBodyNone"><a class="el" href="group__base__types.html#ga31ddce10b950c4f30d546945beabdcbc">ZB_TRUE</a> &ndash; If the ZCL command was processed by the application.<br  />
<a class="el" href="group__base__types.html#gae0f2d2d69ee138eedec4460449f84431">ZB_FALSE</a> &ndash; The ZCL command will be proceeded by the stack. </td><td class="markdownTableBodyNone">ZCL packet processing callback.  </td></tr>
</table>
<center><b>Processing API calls (selection)</b></center> </dd></dl>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="using_zigbee__z_c_l.html#register_zigbee_device">Registering device context</a> is required before calling <a class="el" href="group__af__management__service.html#ga549b0a17bcf5d9788c23882d68298142">ZB_AF_SET_ENDPOINT_HANDLER()</a>.</dd></dl>
<h3><a class="anchor" id="process_zcl_cmd_implementing"></a>
Implementing algorithm for overriding the handling of ZCL commands</h3>
<p>To process an incoming ZCL command, implement the following algorithm in the ZCL packet handler callback:</p><ol type="1">
<li>Extract the incoming ZCL command information from the incoming buffer: <div class="fragment"><div class="line"><a class="code" href="group__buf.html#ga72fb48e56b8e7f4b0cf12d12bd491b3b">zb_bufid_t</a> zcl_cmd_buf = param;</div>
<div class="line"><a class="code" href="structzb__zcl__parsed__hdr__s.html">zb_zcl_parsed_hdr_t</a> *cmd_info = <a class="code" href="group__buf.html#gaf7e0718a3bb63059a2626ac98b54d65d">ZB_BUF_GET_PARAM</a>(zcl_cmd_buf, <a class="code" href="structzb__zcl__parsed__hdr__s.html">zb_zcl_parsed_hdr_t</a>);</div>
</div><!-- fragment --></li>
<li>Check command direction (the <code>cmd_direction</code> field of the <code>zb_zcl_parsed_hdr_t</code> structure):<ul>
<li>towards a server: <a class="el" href="group__zb__zcl__common__frame.html#gaa917766910fc90aaf9821766804bf50d">ZB_ZCL_FRAME_DIRECTION_TO_SRV</a>, or</li>
<li>towards a client: <a class="el" href="group__zb__zcl__common__frame.html#ga9cc3a5ebda57c8e03d39f9118e5c8e3b">ZB_ZCL_FRAME_DIRECTION_TO_CLI</a>.</li>
</ul>
</li>
<li>Check whether the command is general or cluster-specific.<ul>
<li>When the command is general, the <code>is_common_command</code> field of the <a class="el" href="group__zb__zcl__common__frame.html#ga066695d1a2029480e467634a00de734e">zb_zcl_parsed_hdr_t</a> structure is set to 1.</li>
<li>When the command is cluster-specific, the <code>is_common_command</code> field is set to 0.</li>
</ul>
</li>
<li>Check the designated cluster ID: <code>cmd_info -&gt; cluster_id</code> field of the <a class="el" href="group__zb__zcl__common__frame.html#ga066695d1a2029480e467634a00de734e">zb_zcl_parsed_hdr_t</a> structure.</li>
<li>Check the command ID: <code>cmd_info -&gt; cmd_id</code> field of the <a class="el" href="group__zb__zcl__common__frame.html#ga066695d1a2029480e467634a00de734e">zb_zcl_parsed_hdr_t</a> structure.<ul>
<li>The general ZCL command identifiers are listed in the <a class="el" href="group___z_b___z_c_l___c_o_m_m_a_n_d_s.html#ga07a9599cbfb5b62913abcf241c8eeb1e">zb_zcl_cmd_t</a> enumeration.</li>
<li>Cluster-specific command identifiers are defined in the corresponding cluster headers.</li>
</ul>
</li>
<li>Depending on the check results:<ul>
<li>Handle the command.</li>
<li>Let the stack do the handling.</li>
</ul>
</li>
</ol>
<p>If the incoming command was processed by the application:</p><ul>
<li>the buffer must be released by <a class="el" href="group__buf.html#ga788a473df6d535c19f5da0d142d4fa01">zb_buf_free(zb_bufid_t bufid)</a> (if it was not reused),</li>
<li>the callback must return <a class="el" href="group__base__types.html#ga31ddce10b950c4f30d546945beabdcbc">ZB_TRUE</a>.</li>
</ul>
<p>Otherwise, return <a class="el" href="group__base__types.html#gae0f2d2d69ee138eedec4460449f84431">ZB_FALSE</a> to indicate to the stack to perform the default command processing.</p>
<h2><a class="anchor" id="zigbee_device_callback"></a>
Implementing Zigbee device callback</h2>
<p>Zigbee device callback is an optional callback, but in case of usage ZCL clusters from the table below, implementing of the Zigbee device callback becomes mandatory. It is called by the stack's default ZCL cluster handlers to notify the application about a certain event. The event can be caused either by the incoming ZCL command or by the internal stack logic.</p>
<dl class="section note"><dt>Note</dt><dd>When using ZCL clusters from <a class="el" href="using_zigbee__z_c_l.html#zigbee_device_callback_table">the cluster callback table</a>, implementing the Zigbee device callback becomes mandatory.</dd></dl>
<p>The "device" word in the callback name indicates that the application must react as a real device. For example, change the brightness level of the lamp on ZB_ZCL_LEVEL_CONTROL_SET_VALUE_CB_ID callback.</p>
<p>With a call to <a class="el" href="group__af__management__service.html#ga9df506ef2a06d883d7d39f545b55da8d">ZB_ZCL_REGISTER_DEVICE_CB()</a>, the application can register a callback function that takes the reference to a buffer as the input parameter. This buffer carries the parameter <a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#ga0dfcc989252b93252f8bb1d27d2639fa">zb_zcl_device_callback_param_t</a> (see <a class="el" href="zigbee_prog_principles.html#zigbee_stack_memory_mgmt">Zigbee stack memory management subsystem</a> for information about how to get a parameter from the buffer).</p>
<p>To check what action triggered the callback, refer to the field <code>device_cb_id</code> of the received parameter. All the cases are listed in the <a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gad27454b213ce8a00540ebc75288966ad">zb_zcl_device_callback_id_t</a> enumeration. Do not perform any blocking operations during the Zigbee device callback implementation. The memory buffer passed as a parameter to this callback must neither be released nor reused by the application because it is managed by the ZCL subsystem.</p>
<dl class="section user"><dt>Examples</dt><dd>A few examples of device callbacks called by the ZBOSS stack:<ul>
<li>Attribute value change <a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266accd01565be931bb352d99ae47a324aca">ZB_ZCL_SET_ATTR_VALUE_CB_ID</a> :<ul>
<li>by Write Attribute,</li>
<li>by special ZCL command,</li>
<li>by scene change.</li>
</ul>
</li>
<li>Level value change: <a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a9a47e5f178ccee288c0ec99967af8617">ZB_ZCL_LEVEL_CONTROL_SET_VALUE_CB_ID</a>.</li>
<li>Intermediate event in OTA processing: <a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a8a87688c465e80b46ad821741a60fe84">ZB_ZCL_OTA_UPGRADE_VALUE_CB_ID</a>.</li>
</ul>
</dd></dl>
<p><a class="anchor" id="zigbee_device_callback_table"></a></p><dl class="section user"><dt>Cluster callback table</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Cluster </th><th class="markdownTableHeadNone">Callbacks list  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___o_n___o_f_f.html">ZCL On/Off cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a56774d84d04249c2f07d3ed92052ac00">ZB_ZCL_ON_OFF_WITH_EFFECT_VALUE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="2"><a class="el" href="group___z_b___z_c_l___s_h_a_d_e___c_o_n_f_i_g.html">ZCL Shade Configuration cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a7e084feec6bd333001de9ecebb9cfa1e">ZB_ZCL_SHADE_SET_VALUE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a62a6e0ec4246935657594fedf0f8cee3">ZB_ZCL_SHADE_GET_VALUE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_d_e_n_t_i_f_y.html">ZCL Identify cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a4603c4302c3d36d0e640af8a99082745">ZB_ZCL_IDENTIFY_EFFECT_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___l_e_v_e_l___c_o_n_t_r_o_l.html">ZCL Level control cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a9a47e5f178ccee288c0ec99967af8617">ZB_ZCL_LEVEL_CONTROL_SET_VALUE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___b_a_s_i_c.html">ZCL Basic cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a918c694a3e7d3b6f6078995556f44bfb">ZB_ZCL_BASIC_RESET_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___t_h_e_r_m_o_s_t_a_t.html">ZCL Thermostat cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a5a896ee92926c6c8e53f2cc87df91deb">ZB_ZCL_THERMOSTAT_VALUE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___p_o_l_l___c_o_n_t_r_o_l.html">ZCL Poll Control cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a0642f957dd4a587bf1dcf2d8f5b32b8f">ZB_ZCL_POLL_CONTROL_CHECK_IN_CLI_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_a_s___z_o_n_e.html">ZCL IAS Zone cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a711e0bc6da96a205ae8a6091bec6eb59">ZB_ZCL_IAS_ZONE_ENROLL_RESPONSE_VALUE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="2"><a class="el" href="group___z_b___z_c_l___i_a_s___w_d.html">ZCL IAS WD cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ae251b9d7ac698d396bdef483b502f29d">ZB_ZCL_IAS_WD_START_WARNING_VALUE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ae6ab1d6a3492a1ad019360bb87afa922">ZB_ZCL_IAS_WD_SQUAWK_VALUE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="8"><a class="el" href="group___z_b___z_c_l___i_a_s___a_c_e.html">ZCL IAS ACE cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a1d163d63b62a5d719ab38c97e562504f">ZB_ZCL_IAS_ACE_ARM_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266aad774f820202b1bb86502564991fe486">ZB_ZCL_IAS_ACE_BYPASS_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a9a2860f9c09b5345b88cd9791f87a115">ZB_ZCL_IAS_ACE_EMERGENCY_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a99cf11b9fb855a5455919f4eb8866407">ZB_ZCL_IAS_ACE_FIRE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a034b4ea44f16acce728fb598b7f0679b">ZB_ZCL_IAS_ACE_PANIC_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a71196c7e71ec73c8c432bedce9b377f9">ZB_ZCL_IAS_ACE_GET_PANEL_STATUS_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ae768a1d9b387e60003595ae733fb7445">ZB_ZCL_IAS_ACE_GET_BYPASSED_ZONE_LIST_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a5872ddad53cb69acb14b20827672f047">ZB_ZCL_IAS_ACE_GET_ZONE_STATUS_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="9"><a class="el" href="group___z_b___z_c_l___i_a_s___a_c_e.html">ZCL IAS ACE cluster</a> (Client) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a7784bea1bf7f8f6229296a5be6ff25bf">ZB_ZCL_IAS_ACE_ARM_RESP_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a06c2d34611ba1c99f0635abf9ff7e461">ZB_ZCL_IAS_ACE_GET_ZONE_ID_MAP_RESP_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a37eaca247c21582fa46a881613466fcc">ZB_ZCL_IAS_ACE_GET_ZONE_INFO_RESP_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a777e1f7db176b415b0f5b88506b48240">ZB_ZCL_IAS_ACE_ZONE_STATUS_CHANGED_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266aaf401d80b7d8e64d9860ba9429bc0fbc">ZB_ZCL_IAS_ACE_PANEL_STATUS_CHANGED_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a1ee47de22a5d3376f54e8bbed51bbfe4">ZB_ZCL_IAS_ACE_GET_PANEL_STATUS_RESP_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266af5e3f9369d92745edfba27880a2f5751">ZB_ZCL_IAS_ACE_SET_BYPASSED_ZONE_LIST_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a9e0ed0eaf740d7664dae88845da6e0b8">ZB_ZCL_IAS_ACE_BYPASS_RESP_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a16ac33affc4955e8ae2eb67b65b74b3e">ZB_ZCL_IAS_ACE_GET_ZONE_STATUS_RESP_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___o_t_a___u_p_g_r_a_d_e.html">ZCL OTA Upgrade cluster</a> (Client) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a8a87688c465e80b46ad821741a60fe84">ZB_ZCL_OTA_UPGRADE_VALUE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="4"><a class="el" href="group___z_b___z_c_l___o_t_a___u_p_g_r_a_d_e.html">ZCL OTA Upgrade cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ac9bcb7b0e81a37f235cf732236107ff6">ZB_ZCL_OTA_UPGRADE_SRV_QUERY_IMAGE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266aeb446d6a07e2b3c5734e70891add2fb8">ZB_ZCL_OTA_UPGRADE_SRV_UPGRADE_STARTED_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a86bbdeccd2c631a3e1a40599928dcc5f">ZB_ZCL_OTA_UPGRADE_SRV_UPGRADE_ABORTED_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ab01261e7f003897540a73fdf611ce511">ZB_ZCL_OTA_UPGRADE_SRV_UPGRADE_END_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___e_n50523___a_p_p___e_v_e_n_t_s___a_l_e_r_t_s.html">EN50523 Appliance events and alerts cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a4c6edafc762fff14797d26e3041c08bf">ZB_ZCL_EN50523_APPL_EV_AND_ALERTS_GET_ALERTS_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="3"><a class="el" href="group___z_b___z_c_l___e_n50523___a_p_p___e_v_e_n_t_s___a_l_e_r_t_s.html">EN50523 Appliance events and alerts cluster</a> (Client) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a1db96f2e1ac6d8fa00f3a3b93799ec1a">ZB_ZCL_EN50523_APPL_EV_AND_ALERTS_GET_ALERTS_RESP_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a8e484673354de2b7fb8dbdb26579ff5f">ZB_ZCL_EN50523_APPL_EV_AND_ALERTS_ALERTS_NOTIFICATION_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a2d99e355de56611a5061dce04dba8913">ZB_ZCL_EN50523_APPL_EV_AND_ALERTS_EVENT_NOTIFICATION_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="4"><a class="el" href="group___z_b___z_c_l___p_r_i_c_e.html">ZCL Price cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ae3805b9de2f37afa5a70ee7feef36a7e">ZB_ZCL_PRICE_GET_CURRENT_PRICE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a24e84e44394eff5372fe08b8be512c3f">ZB_ZCL_PRICE_GET_SCHEDULED_PRICES_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ac1b823860b5b00c12e45a9ece864503b">ZB_ZCL_PRICE_GET_TIER_LABELS_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ac8450ffe559959db8353039216be89a2">ZB_ZCL_PRICE_PRICE_ACK_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="2"><a class="el" href="group___z_b___z_c_l___p_r_i_c_e.html">ZCL Price cluster</a> (Client) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a3bba55bc437e5f0faab716fe911c2cec">ZB_ZCL_PRICE_PUBLISH_PRICE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a19e8879c2a7d686375be5846a9e9849b">ZB_ZCL_PRICE_PUBLISH_TIER_LABELS_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="2"><a class="el" href="group___z_b___z_c_l___d_r_l_c.html">ZCL Demand Response and Load Control (DRLC) cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a7d231513bed231f0d6ef1d6fb442b2df">ZB_ZCL_DRLC_REPORT_EVENT_STATUS_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a085cd7bb2a8e0de3115d4a2602b18e44">ZB_ZCL_DRLC_GET_SCHEDULED_EVENTS_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="3"><a class="el" href="group___z_b___z_c_l___d_r_l_c.html">ZCL Demand Response and Load Control (DRLC) cluster</a> (Client) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a82c8fcc9a92f0042e88ce9394b4dbe6a">ZB_ZCL_DRLC_LOAD_CONTROL_EVENT_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266abf656fce7e7232d3d8553f747186bc03">ZB_ZCL_DRLC_CANCEL_LOAD_CONTROL_EVENT_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a333529124a759fed16138e4413a8db6a">ZB_ZCL_DRLC_CANCEL_ALL_LOAD_CONTROL_EVENTS_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="2"><a class="el" href="group___z_b___z_c_l___m_e_s_s_a_g_i_n_g.html">ZCL Messaging cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a90bd61f5d8cffabe609d0f33d277ff62">ZB_ZCL_MESSAGING_MSG_CONFIRMATION_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ab9c419cdad57b673ec97c72f95bd1810">ZB_ZCL_MESSAGING_GET_LAST_MSG_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="2"><a class="el" href="group___z_b___z_c_l___m_e_s_s_a_g_i_n_g.html">ZCL Messaging cluster</a> (Client) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ac95029d296adcd7d927723f64f5aa606">ZB_ZCL_MESSAGING_CANCEL_MSG_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ae7a187edc243a90b0f7243257a3273dd">ZB_ZCL_MESSAGING_DISPLAY_MSG_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="4"><a class="el" href="group___z_b___z_c_l___t_u_n_n_e_l_i_n_g.html">ZCL Tunneling cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a902afade21422598de20481123ed5fe8">ZB_ZCL_TUNNELING_REQUEST_TUNNEL_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a56cbb74b9e49a9304e935621cf0d379b">ZB_ZCL_TUNNELING_TRANSFER_DATA_CLI_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a25c5085b7070a8e4b5e48910434a2360">ZB_ZCL_TUNNELING_TRANSFER_DATA_ERROR_CLI_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266adbef5c4243a6e860c91a6900721dea9b">ZB_ZCL_TUNNELING_CLOSE_TUNNEL_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="3"><a class="el" href="group___z_b___z_c_l___t_u_n_n_e_l_i_n_g.html">ZCL Tunneling cluster</a> (Client) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a82bd67c58c9b74925ef8b989a20091f3">ZB_ZCL_TUNNELING_REQUEST_TUNNEL_RESPONSE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266adce08bcafb8fbc3c6a528667901f3281">ZB_ZCL_TUNNELING_TRANSFER_DATA_SRV_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a5fa20adffa31ca8d4d96f86778e74501">ZB_ZCL_TUNNELING_TRANSFER_DATA_ERROR_SRV_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="4"><a class="el" href="group___z_b___z_c_l___m_e_t_e_r_i_n_g.html">ZCL Metering Cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ac4669dfe92b15040cb59cd3c70e4ff3e">ZB_ZCL_METERING_GET_PROFILE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a601ebaab24e8a61908a99db1d6eb1bef">ZB_ZCL_METERING_REQUEST_FAST_POLL_MODE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a632aae20e5016810563aaf00220ad090">ZB_ZCL_METERING_GET_SNAPSHOT_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ad8b429681da3b6c7cd8163f89775045e">ZB_ZCL_METERING_GET_SAMPLED_DATA_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="4"><a class="el" href="group___z_b___z_c_l___m_e_t_e_r_i_n_g.html">ZCL Metering Cluster</a> (Client) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a8890fe0dc10079ef25ea5093a283521c">ZB_ZCL_METERING_GET_PROFILE_RESPONSE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ab6f26cf027543a4c6483d9dfd7028f58">ZB_ZCL_METERING_REQUEST_FAST_POLL_MODE_RESPONSE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a06be508d315bb05aa82383ce31288fd0">ZB_ZCL_METERING_PUBLISH_SNAPSHOT_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a1130fc9cecf8628444bc92723a616a19">ZB_ZCL_METERING_GET_SAMPLED_DATA_RESPONSE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="5"><a class="el" href="group___z_b___z_c_l___w_i_n_d_o_w___c_o_v_e_r_i_n_g.html">ZCL Window Covering cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ad38d45f81d8be8d38499c3abd32b9ffc">ZB_ZCL_WINDOW_COVERING_UP_OPEN_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266abae1cdc18280076c0af319185da4184c">ZB_ZCL_WINDOW_COVERING_DOWN_CLOSE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a3b726eb15be0e5570d0f45e06d2d7bb3">ZB_ZCL_WINDOW_COVERING_STOP_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ac528ffc821d3eaaecb8e4f06d8621037">ZB_ZCL_WINDOW_COVERING_GO_TO_LIFT_PERCENTAGE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a42fe7bdb063df4934a0c188478b5587e">ZB_ZCL_WINDOW_COVERING_GO_TO_TILT_PERCENTAGE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="2"><a class="el" href="group___z_b___z_c_l___d_o_o_r___l_o_c_k.html">ZCL DoorLock cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ad41c987dc388b808d2accd3380fd64d7">ZB_ZCL_DOOR_LOCK_LOCK_DOOR_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a13d288e361523ec5b8a369fc809a7071">ZB_ZCL_DOOR_LOCK_UNLOCK_DOOR_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="2"><a class="el" href="group___z_b___z_c_l___d_o_o_r___l_o_c_k.html">ZCL DoorLock cluster</a> (Client) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a6712ee87d89e423455bb7c6e9d36cce8">ZB_ZCL_DOOR_LOCK_LOCK_DOOR_RESP_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a74c4b2fb1ff4ec77ff20367e851c3049">ZB_ZCL_DOOR_LOCK_UNLOCK_DOOR_RESP_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="2"><a class="el" href="group___z_b___z_c_l___a_l_a_r_m_s.html">ZCL Alarms cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a65e72e76e03feba7d76b59a28547265b">ZB_ZCL_ALARMS_RESET_ALARM_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ab721458f3c250cce5beeeda4986129ef">ZB_ZCL_ALARMS_RESET_ALL_ALARMS_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___a_l_a_r_m_s.html">ZCL Alarms cluster</a> (Client) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a6c92cf200a7e93c4731c7c45ad356e51">ZB_ZCL_ALARMS_ALARM_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone" rowspan="4"><a class="el" href="group___z_b___z_c_l___w_w_a_h.html">ZCL Work With All Hubs (WWAH) cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ae6765dd76cabd4db3dc261f55f59fcd7">ZB_ZCL_WWAH_ENABLE_APP_EVENT_RETRY_ALGORITHM_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266aabfd999dee733d55891682fe66db0b43">ZB_ZCL_WWAH_DISABLE_APP_EVENT_RETRY_ALGORITHM_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266afaf91f471885c9e0b5ee52270474eb62">ZB_ZCL_WWAH_DEBUG_REPORT_QUERY_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a43798d10efde09a30d0def57b64fa37e">ZB_ZCL_WWAH_SET_IAS_ZONE_ENROLLMENT_METHOD_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___c_o_n_t_r_o_l4.html">ZCL Control4 Network cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a48ef6304bcd31a530c4be657d6292ef3">ZB_ZCL_CONTROL4_NETWORK_ZAP_INFO_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone" rowspan="9"><a class="el" href="group___z_b___z_c_l___s_c_e_n_e_s.html">ZCL Scenes cluster</a> (Server) </td><td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ad52c9a1a95bdd8de4d71e8ede2c67467">ZB_ZCL_SCENES_ADD_SCENE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a30fad644c7cb69ebf347cf42d0e75df3">ZB_ZCL_SCENES_STORE_SCENE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a2431148ba781a6c7d4f3cafbe8909556">ZB_ZCL_SCENES_VIEW_SCENE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266aec10603b67af08647484ead79b62d0d0">ZB_ZCL_SCENES_REMOVE_SCENE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266adf2741406ad20fed5ca645588df57cce">ZB_ZCL_SCENES_REMOVE_ALL_SCENES_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266ae7a3fad270a151873212bc19a6a969cc">ZB_ZCL_SCENES_RECALL_SCENE_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266acd8de860ce3bff77b03e60c49a536f36">ZB_ZCL_SCENES_GET_SCENE_MEMBERSHIP_CB_ID</a>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a9d166d05e8a1fbdd4ab9aa78918ad6b9">ZB_ZCL_SCENES_INTERNAL_REMOVE_ALL_SCENES_ALL_ENDPOINTS_CB_ID</a>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a72f2fcd08175c9cbdbb2046d4b2111ca">ZB_ZCL_SCENES_INTERNAL_REMOVE_ALL_SCENES_ALL_ENDPOINTS_ALL_GROUPS_CB_ID</a>  </td></tr>
</table>
<center><b> ZCL cluster callbacks </b></center><h2><a class="anchor" id="zcl_cmds_send"></a>
Sending ZCL commands</h2>
<p>The SDK provides API calls for sending and parsing ZCL packets for general command frames and cluster-specific commands.</p>
<dl class="section user"><dt>Naming convention</dt><dd>The naming convention is not strict. Usually, it is composed of the following elements:<ul>
<li>cluster name (for general commands, it is replaced with GENERAL),</li>
<li>verb describing an action,</li>
<li>command name. <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Macro example </th><th class="markdownTableHeadNone">Cluster name </th><th class="markdownTableHeadNone">Action verb </th><th class="markdownTableHeadNone">Command  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___o_n___o_f_f.html#gaef6fe57e14d7cda3a5ef136608e3345c">ZB_ZCL_ON_OFF_SEND_TOGGLE_REQ()</a> </td><td class="markdownTableBodyNone">On/Off </td><td class="markdownTableBodyNone">Send </td><td class="markdownTableBodyNone">Toggle  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_a_s___z_o_n_e.html#gaec91e4a606811aa6af5b741da24fd181">ZB_ZCL_IAS_ZONE_SEND_STATUS_CHANGE_NOTIFICATION_REQ()</a> </td><td class="markdownTableBodyNone">IAS zone </td><td class="markdownTableBodyNone">Send </td><td class="markdownTableBodyNone">Zone notification  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__read__attr__command.html#gaf319d4043766654057d025b50bb1614b">ZB_ZCL_GENERAL_INIT_READ_ATTR_REQ()</a><br  />
<a class="el" href="group__read__attr__command.html#ga48138736278d4cdc5208e504fce33925">ZB_ZCL_GENERAL_ADD_ID_READ_ATTR_REQ()</a><br  />
<a class="el" href="group__read__attr__command.html#gae456ab6331127420aa674ad2f2808c48">ZB_ZCL_GENERAL_SEND_READ_ATTR_REQ()</a> </td><td class="markdownTableBodyNone">(general commands) </td><td class="markdownTableBodyNone">Initialize<br  />
Add<br  />
Send </td><td class="markdownTableBodyNone">Read Attribute  </td></tr>
</table>
<center><b>Sending ZCL commands: Naming convention examples</b></center></li>
</ul>
</dd></dl>
<dl class="section user"><dt>API command structure</dt><dd>The command can have a predefined or a variable size:<ul>
<li>If a command has a predefined size, it is composed and sent with one API call.<ul>
<li>The Toggle command is an example of this type of command.</li>
</ul>
</li>
<li>If a command has a variable size, it is composed dynamically at runtime.<ul>
<li>The Read Attribute command is an example of this type of command. An application can call <a class="el" href="group__read__attr__command.html#ga48138736278d4cdc5208e504fce33925">ZB_ZCL_GENERAL_ADD_ID_READ_ATTR_REQ()</a> several times to add more attribute IDs to read.</li>
</ul>
</li>
</ul>
</dd></dl>
<p>To construct a manufacturer-specific command (or a standard command that is not supported by the API yet), use the low-level API:</p><ul>
<li>A function to initialize a ZCL packet: <a class="el" href="group__zb__zcl__common__frame.html#ga5036c195cfe382a89b88be2545510646">zb_zcl_start_command_header()</a></li>
<li>Primitives to fill in the packet data:<ul>
<li><a class="el" href="group__zb__zcl__common__pckt__fill.html#ga6e13da1d65be6845c151d196b03491d6">ZB_ZCL_PACKET_PUT_DATA8</a></li>
<li><a class="el" href="group__zb__zcl__common__pckt__fill.html#ga46e8b70306c0db144b3bcb70e837e2c6">ZB_ZCL_PACKET_PUT_DATA16</a></li>
<li><a class="el" href="group__zb__zcl__common__pckt__fill.html#gae4d63a41ee4f9cf65b05f502ba71415a">ZB_ZCL_PACKET_PUT_DATA32</a></li>
<li><a class="el" href="group__zb__zcl__common__pckt__fill.html#ga310502f6adff05cafddad072ec0d5232">ZB_ZCL_PACKET_PUT_DATA_IEEE</a></li>
<li><a class="el" href="group__zb__zcl__common__pckt__fill.html#ga3910a5dfcb10b5ce502478978d027bed">ZB_ZCL_PACKET_PUT_DATA_N</a></li>
</ul>
</li>
<li>A function to finalize the packet and to send it: <a class="el" href="group__zb__zcl__common__pckt__fill.html#gabb77c2cad973abe7144586a4112c3463">zb_zcl_finish_and_send_packet()</a></li>
</ul>
<p>Optionally, a callback can be initiated by including a callback function into a packet. On return, it contains the following parameters:</p><ul>
<li>at the begining of the buffer (<a class="el" href="group__buf.html#ga97fe9fcc0124718cc25c3710b752b8fd">zb_buf_begin(zb_bufid_t bufid)</a>): the original ZCL request</li>
<li>at the end of the buffer (<a class="el" href="group__buf.html#gaf7e0718a3bb63059a2626ac98b54d65d">ZB_BUF_GET_PARAM(buf, type)</a>): status of the transmission (<a class="el" href="group___z_b___z_c_l___c_o_m_m_o_n.html#gab8566a2dbbecff4f893e6b7842c73388">zb_zcl_command_send_status_t</a>)</li>
</ul>
<h2><a class="anchor" id="zcl_cmd_parse"></a>
Parsing ZCL commands</h2>
<p>The API for parsing the received ZCL packets for general command frames and cluster-specific commands is similar to the API for <a class="el" href="using_zigbee__z_c_l.html#zcl_cmds_send">Sending ZCL commands</a>.</p><ul>
<li>In most cases, the stack automatically parses the incoming command and calls the corresponding ZCL callback (if needed).<ul>
<li>This is true for all mandatory Request commands (both general and cluster-specific, for example Read Attributes Request, On/Off Cluster's On command, etc.).</li>
</ul>
</li>
<li>For most of the attribute-changing commands, the stack uses one unified SET_ATTRIBUTE callback with specified cluster ID, attribute ID and a new value.<ul>
<li>This is true, for example, for On/Off, Level Control, Color Control etc.</li>
<li>Otherwise, the application needs to parse this command in the zcl_specific_cmd_handler.<ul>
<li>This is true for most of the responses, when the request is generated from the application and is not related to the stack logic (for example, Read Attributes Response, IAS Zone Status Change Notification, etc.).</li>
</ul>
</li>
</ul>
</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>All OTA commands are parsed by the stack. In general, if a command has a corresponding ZCL callback, it is parsed by the stack.</dd></dl>
<dl class="section user"><dt>Naming convention</dt><dd>The API command name is composed of the following elements:<ul>
<li>cluster name (for general commands, it is replaced with GENERAL),</li>
<li>verb describing an action,</li>
<li>command name. <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Macro example </th><th class="markdownTableHeadNone">Cluster name </th><th class="markdownTableHeadNone">Action verb </th><th class="markdownTableHeadNone">Command </th><th class="markdownTableHeadNone">Additional information  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group___z_b___z_c_l___i_a_s___z_o_n_e.html#ga277fa6f8b756ec9328994724125ecaf3">ZB_ZCL_IAS_ZONE_GET_STATUS_CHANGE_NOTIFICATION_REQ()</a> </td><td class="markdownTableBodyNone">IAS zone </td><td class="markdownTableBodyNone">Get </td><td class="markdownTableBodyNone">Zone notification </td><td class="markdownTableBodyNone">Fills in a variable of the <a class="el" href="group___z_b___z_c_l___i_a_s___z_o_n_e.html#ga8f131e3d4f1c45e3d1726d8be93e8562">zb_zcl_ias_zone_status_change_not_t</a> type.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group__read__attr__command.html#ga4e54806a8a1d53d772726790a6eba3b3">ZB_ZCL_GENERAL_GET_NEXT_READ_ATTR_RES()</a> </td><td class="markdownTableBodyNone">(general command) </td><td class="markdownTableBodyNone">Get </td><td class="markdownTableBodyNone">Read Attribute </td><td class="markdownTableBodyNone">Parses the Read Attribute response.  </td></tr>
</table>
<center><b>Parsing ZCL commands: Naming convention examples</b></center> The parsing API is not provided for commands without a payload, for example the Toggle command in the On/Off cluster. If the received packet is parsed manually, use <a class="el" href="group___z_b___z_c_l___c_o_m_m_o_n.html#gaccac844ddab16d2937644439c7f71efc">ZB_ZCL_FIX_ENDIAN</a> API to keep the right endianness in the packet.</li>
</ul>
</dd></dl>
<hr  />
<h1><a class="anchor" id="zcl_zigbee_commissioning"></a>
Support for Zigbee commissioning</h1>
<p>The commissioning logic is based on Zigbee BDB specification, and is divided into the following types:</p><ul>
<li>Normal commissioning (network steering, formation, finding and binding),</li>
</ul>
<p>Other types of commissioning like the legacy HA or the ZLL commissioning are supported, but not recommended.</p>
<p>You can configure commissioning by setting parameters before the start of the stack.</p>
<h2><a class="anchor" id="zcl_zigbee_commissioning_config_seq"></a>
Commissioning configuration sequence</h2>
<p>There are several commissioning parameters that can be assigned by the application or stored in NVRAM, or both. The default parameters are coded in the application firmware. Then they can be updated by the NVRAM content.</p>
<p>The commissioning configuration sequence is made of the following steps:</p><ol type="1">
<li>If needed, the application makes an API call to tune commissioning by changing the default values.<ul>
<li><b>Example 1</b>: set hard-coded long address (useful for debugging): <code>zb_set_long_address(g_ed_addr)</code>;</li>
<li><b>Example 2</b>: set a ZED at channel 2: <code>zb_set_network_ed_role(1l&lt;&lt;21)</code>;</li>
</ul>
</li>
<li>The application calls zigbee_enable().<ol type="a">
<li>The stack loads NVRAM and updates internal parameters, for example working channel, short address, binding information.</li>
<li>The stack loads the production configuration from the flash memory. This can possibly modify some settings related to the implementation of a Zigbee device.</li>
<li>The stack continues the starting process. If a device joins the network, the stack updates the short address and stores it in NVRAM.</li>
</ol>
</li>
<li>The application does some commission actions (like binding) at runtime, after successful start and join.<ul>
<li>The stack stores the binding information in NVRAM to be able to restore it at reboot.</li>
</ul>
</li>
</ol>
<h2><a class="anchor" id="network_config_general"></a>
Network configuration settings (general)</h2>
<p>The stack implements all Zigbee roles: a coordinator, a router, and an end device. Only one role can be defined in a Zigbee application. Switching Zigbee role at runtime is not supported.</p>
<p>Different libraries are provided for each role, and the application must be linked to them:</p><ul>
<li>For the coordinator or router: <code>libzboss.a</code>,</li>
<li>For the end device: <code>libzboss.ed.a</code>.</li>
</ul>
<p>See the following table for the overview of functions for setting the device role.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Macro </th><th class="markdownTableHeadNone">Parameters </th><th class="markdownTableHeadNone">Return value </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__zb__general__set.html#ga5477c6761f15cdc4203f538e83089c4e">zb_set_network_coordinator_role(zb_uint32_t channel_mask)</a> </td><td class="markdownTableBodyNone"><code>channel_mask</code> &ndash; mask used to define the primary channel set. </td><td class="markdownTableBodyNone">None. </td><td class="markdownTableBodyNone">Initiate device as a Zigbee coordinator.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group__zb__general__set.html#ga7c7d5d158aad47d8a161d11ec6213f92">zb_set_network_router_role(zb_uint32_t channel_mask)</a> </td><td class="markdownTableBodyNone"><code>channel_mask</code> &ndash; mask used to define the primary channel set. </td><td class="markdownTableBodyNone">None. </td><td class="markdownTableBodyNone">Initiate device as a Zigbee router.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__zb__general__set.html#gaf118f276259f34a01615752783ea68bd">zb_set_network_ed_role(zb_uint32_t channel_mask)</a> </td><td class="markdownTableBodyNone"><code>channel_mask</code> &ndash; mask used to define the primary channel set. </td><td class="markdownTableBodyNone">None. </td><td class="markdownTableBodyNone">Initiate device as a Zigbee end device.  </td></tr>
</table>
<center><b>Functions for setting the device role</b></center><p>For the complete list of settings, see the <a class="el" href="group__zboss__general__api.html">Application structure &amp; commissioning start</a> section in the <a class="el" href="group__api__zb.html">Zigbee stack API</a> reference documentation.</p>
<h2><a class="anchor" id="network_config_bdb"></a>
Network configuration settings (BDB-specific)</h2>
<p>The <code>channel_mask</code> parameter is a bit field that defines the Zigbee channels to be used for the energy scan as the primary channel set. Bits from 11 to 26 are used to control the channel selection. Each bit enables or disables the corresponding channel. To set all channel masks (enable all channels), use the macro <code>ZB_TRANSCEIVER_ALL_CHANNELS_MASK</code>.</p>
<p>BDB has an abstraction of primary and secondary channel mask. By default, the secondary channel mask is the same, but you can define it separately by using the call <a class="el" href="group__zboss__bdb__comm__params.html#gab8dda16debfbafe21b6326256770f39a">zb_set_bdb_secondary_channel_set(zb_uint32_t channel_mask)</a>.</p>
<p>For details on the abstraction of primary and secondary channel mask and the complete network configuration API, see the official Zigbee BDB specification.</p>
<p>The following functions can modify the settings of the BDB channel:</p><ul>
<li><a class="el" href="group__zboss__bdb__comm__params.html#gaf97c13692fc1afce7e357f1b30726513">zb_set_bdb_primary_channel_set()</a></li>
<li><a class="el" href="group__zboss__bdb__comm__params.html#gab56e8c2d9813a338cd4162896fdc7e66">zb_get_bdb_primary_channel_set()</a></li>
<li><a class="el" href="group__zboss__bdb__comm__params.html#gab8dda16debfbafe21b6326256770f39a">zb_set_bdb_secondary_channel_set()</a></li>
<li><a class="el" href="group__zboss__bdb__comm__params.html#ga5b29ce5f194bffed5a1114d218a1fe0a">zb_get_bdb_secondary_channel_set()</a></li>
</ul>
<p>To start the implicit BDB commissioning after the <a class="el" href="group__zb__general__start.html#ga31b4d46033aaf6a400409d03bd40d392" title="ZBOSS start function.">zboss_start()</a> call, use the <a class="el" href="group__zboss__bdb__comm__start.html#ga62cd72324b54be9b1b9ae411c899613e" title="Set commissioning mode.">zb_set_bdb_commissioning_mode()</a> function. Its parameter is a bitmask that specifies the BDB commissioning mode. See the official Zigbee BDB specification for detailed description. For more details about the API, see the <a class="el" href="group__zboss__bdb__api.html">BDB commissioning API</a> section in the <a class="el" href="group__api__zb.html">Zigbee stack API</a> documentation.</p>
<h2><a class="anchor" id="stack_start_initiation"></a>
Stack commissioning start sequence</h2>
<p>You can use one of the following functions for the stack initialization:</p><ul>
<li><a class="el" href="group__zb__general__start.html#ga31b4d46033aaf6a400409d03bd40d392" title="ZBOSS start function.">zboss_start()</a> to initialize the radio and start commissioning according to parameters that you set after the initialization is complete.</li>
<li><a class="el" href="group__zb__general__start.html#ga233ee91013eb2e777bc0b796620e1b36">zboss_start_no_autostart()</a> to delay commissioning until an action takes place.</li>
</ul>
<p>The <a class="el" href="group__zb__general__start.html#ga233ee91013eb2e777bc0b796620e1b36">zboss_start_no_autostart()</a> function does only minimal initialization of the stack framework, enough to have the multitasking and the memory management. The stack initializes its base structures, reads NVRAM, starts the scheduler, but does not initialize Zigbee data structures and radio. It then calls <a class="el" href="group__zb__comm__signals.html#gae05c0ff285cfd03e0997fe438e8047fc">zboss_signal_handler()</a> with <a class="el" href="group__zb__comm__signals.html#gab2b9e7a13fd471d7bb642655d825a04e">ZB_ZDO_SIGNAL_SKIP_STARTUP</a> signal. The application should later call ZBOSS commissioning initiation &ndash; <a class="el" href="group__zboss__bdb__comm__start.html#ga0b54e93a19cadc5fc02df8eab18ecd45">bdb_start_top_level_commissioning</a>(<a class="el" href="group__zboss__bdb__comm__start.html#gga9c44bbce9f6f6b19b623837914959c02ae31d4a2067eb711a43f7049b08710299">ZB_BDB_NETWORK_STEERING</a>) that will trigger further commissioning. To avoid triggering commissioning at this point, call <a class="el" href="group__zboss__bdb__comm__start.html#ga0b54e93a19cadc5fc02df8eab18ecd45">bdb_start_top_level_commissioning()</a> with mask 0 that makes the stack proceed with the initialization without steering and commissioning. This option is recommended if:</p><ul>
<li>The application is doing some other hardware initialization before the start of commissioning and prefers to use the stack multitasking during this initialization (for example, read some sensor data through the serial port).</li>
<li>The application does not start commissioning at power-up. Instead, it waits for a user action at every power-up (for example, a button press).</li>
</ul>
<p>After starting <a class="el" href="group__zb__general__main__loop.html#ga80765ed256180c6452ade57d4545b282">zboss_main_loop</a> or <a class="el" href="group__zb__general__main__loop.html#gab9f8bb77c5348ee1dea12ec1026517b1">zboss_main_loop_iteration</a>, the stack will interact with the user application using:</p><ul>
<li>stack signals during internal processes such as commissioning, leave, etc. &ndash; see <a class="el" href="group__zb__comm__signals.html#gae05c0ff285cfd03e0997fe438e8047fc">zboss_signal_handler()</a>.</li>
<li>ZCL callbacks (on incoming ZCL frames) &ndash; see <a class="el" href="using_zigbee__z_c_l.html#zigbee_device_callback">Implementing Zigbee device callback</a>.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The stack provides you with the following ways for calling the main loop:<ul>
<li><a class="el" href="group__zb__general__main__loop.html#ga80765ed256180c6452ade57d4545b282">zboss_main_loop()</a> - by default.</li>
<li><a class="el" href="group__zb__general__main__loop.html#gab9f8bb77c5348ee1dea12ec1026517b1">zboss_main_loop_iteration()</a> - in case the user needs to include custom features.</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Example 1</dt><dd><a class="el" href="group__zb__general__main__loop.html#ga80765ed256180c6452ade57d4545b282">zboss_main_loop()</a> implementation example: <div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__zb__general__start.html#ga31b4d46033aaf6a400409d03bd40d392">zboss_start</a>() == <a class="code" href="group__error__codes.html#ga76117585e8ddc62f21ca0e3061b7830e">RET_OK</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__zb__general__main__loop.html#ga80765ed256180c6452ade57d4545b282">zboss_main_loop</a>();</div>
<div class="line">  }</div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Example 2</dt><dd><a class="el" href="group__zb__general__main__loop.html#gab9f8bb77c5348ee1dea12ec1026517b1">zboss_main_loop_iteration()</a> implementation example: <div class="fragment"><div class="line"><span class="keywordtype">void</span> my_main_loop()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">while</span> (1)</div>
<div class="line">  {</div>
<div class="line">    / ... User code ... /</div>
<div class="line">    <a class="code" href="group__zb__general__main__loop.html#gab9f8bb77c5348ee1dea12ec1026517b1">zboss_main_loop_iteration</a>();</div>
<div class="line">    / ... User code ... /</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> <div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__zb__general__start.html#ga31b4d46033aaf6a400409d03bd40d392">zboss_start</a>() == <a class="code" href="group__error__codes.html#ga76117585e8ddc62f21ca0e3061b7830e">RET_OK</a>)</div>
<div class="line">  {</div>
<div class="line">    my_main_loop();</div>
<div class="line">  }</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">  {</div>
<div class="line">    <span class="comment">/* zboss_start failed */</span></div>
<div class="line">  }</div>
</div><!-- fragment --></dd></dl>
<h2><a class="anchor" id="commissioning_event_handling"></a>
Zigbee commissioning event handling</h2>
<p>As the full-featured Zigbee stack is implemented, all Zigbee commands and events are processed. In addition, there are tools that allow the application to handle some Zigbee events, including network formation, association status, and leave indication. Due to its nature, different Zigbee events appear asynchronously and the stack informs the application with application signals. The application can handle or ignore these signals.</p>
<p>All application signals are processed in the application with a predefined callback function <a class="el" href="group__zb__comm__signals.html#gae05c0ff285cfd03e0997fe438e8047fc">zboss_signal_handler()</a>. Each application must implement this function, even if there is no need to process signals. The prototype for the signal handler function is:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="group__zb__comm__signals.html#gae05c0ff285cfd03e0997fe438e8047fc">zboss_signal_handler</a>(<a class="code" href="group__base__types.html#gaa82a9657ef11a3947586065cf8066256">zb_uint8_t</a> param);</div>
</div><!-- fragment --><p>In this function, <code>param</code> is a reference to a memory buffer.</p>
<dl class="section note"><dt>Note</dt><dd>In the nRF Connect SDK, the processing of the <a class="el" href="group__zb__comm__signals.html#gae05c0ff285cfd03e0997fe438e8047fc">zboss_signal_handler()</a> function can be passed to the <a href="https://developer.nordicsemi.com/nRF_Connect_SDK/doc/latest/nrf/libraries/zigbee/zigbee_error_handler.html" target="_blank">Zigbee default signal handler</a> library. This library is recommended for each Zigbee application in the nRF Connect SDK.</dd></dl>
<p>Take into account the following policies while implementing the <a class="el" href="group__zb__comm__signals.html#gae05c0ff285cfd03e0997fe438e8047fc">zboss_signal_handler()</a> function:</p><ul>
<li>Signal processing must not perform long operations synchronously. As soon as the cooperative multitasking is implemented by the scheduler, each blocking operation blocks the entire Zigbee stack.</li>
<li>If a valid reference to a memory buffer is passed to the application callback function, the application is responsible for managing this memory buffer. The memory buffer must be either reused or released by the application, otherwise the buffer is lost and memory leak occurs.</li>
</ul>
<p>An application signal is described with the following parameters:</p><ul>
<li>Signal ID &ndash; see the <a class="el" href="group__tc__swap.html#zdo_app_signal_type">zdo_app_signal_type</a> section of the API Reference.</li>
<li>Signal status &ndash; the API <a class="el" href="group__zb__comm__signals.html#ga92b8d5cdf1c243e1c47e72fbd0e14083">ZB_GET_APP_SIGNAL_STATUS()</a> is used to get the status.</li>
<li>Signal specific parameters &ndash; these are optionally provided for some signals; to see which parameters correspond to an event, see the description of the signals in the <a class="el" href="group__tc__swap.html#zdo_app_signal_type">zdo_app_signal_type</a> section in <a class="el" href="group__api__zb.html">Zigbee stack API</a>.</li>
</ul>
<p>To get the signal description, the application calls <a class="el" href="group__zb__comm__signals.html#ga03ab4c87fbcc7cf8e12bbfa9cb8a3be6">zb_get_app_signal()</a>. For example: </p><div class="fragment"><div class="line">zb_zdo_app_signal_t <a class="code" href="group__zb__comm__signals.html#ga03ab4c87fbcc7cf8e12bbfa9cb8a3be6">zb_get_app_signal</a>(<a class="code" href="group__base__types.html#gaa82a9657ef11a3947586065cf8066256">zb_uint8_t</a> param, <a class="code" href="structzb__zdo__app__signal__hdr__s.html">zb_zdo_app_signal_hdr_t</a> **p_sg_p);</div>
</div><!-- fragment --><p> Where:</p><ul>
<li><code>param</code> is the reference to a memory buffer,</li>
<li><code>ev_p</code> is the pointer to store the extended event info; can be <code>NULL</code>. The function returns an ID of the application signal.</li>
</ul>
<h2><a class="anchor" id="bdb_commissioning_api"></a>
BDB Commissioning API</h2>
<p>The stack implements procedures for the following BDB commissioning modes:</p><ul>
<li>Network steering</li>
<li>Network formation</li>
<li>Finding and binding</li>
</ul>
<p>The implementation can use commissioning at any time. For example, network steering can be started at any time for the whole node, and finding and binding can be performed at any time on any application endpoint.</p>
<dl class="section note"><dt>Note</dt><dd>An explicit start of commissioning is required if <a class="el" href="group__zb__general__start.html#ga233ee91013eb2e777bc0b796620e1b36">zboss_start_no_autostart()</a> was called instead of <a class="el" href="group__zb__general__start.html#ga31b4d46033aaf6a400409d03bd40d392" title="ZBOSS start function.">zboss_start()</a>. For details, see <a class="el" href="using_zigbee__z_c_l.html#stack_start_initiation">Stack commissioning start sequence</a>.</dd></dl>
<p>The commissioning procedure is initiated by triggering a top-level commissioning procedure with the <a class="el" href="group__zboss__bdb__comm__start.html#ga0b54e93a19cadc5fc02df8eab18ecd45">bdb_start_top_level_commissioning</a> function.</p>
<dl class="section user"><dt>Finding and Binding</dt><dd>The finding and binding procedure can be initiated independently or within the commissioning process. To bind multiple endpoints on a target device with one endpoint on an initiator device, you must run different finding and binding procedures for all endpoint pairs consequently. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>The finding and binding procedure is implemented as a singleton, so there can only be one such procedure running at a time.</dd></dl>
<dl class="section user"><dt></dt><dd>On the initiator device:<ul>
<li>After the network steering completion, call <a class="el" href="group__zboss__bdb__comm__fb.html#gae6fd60a050559ef0aa3c3e5ec32bc515">zb_bdb_finding_binding_initiator</a> that sends the identify query.</li>
<li>When you need to cancel the procedure, call <a class="el" href="group__zboss__bdb__comm__fb.html#gac59426aadfc0c52014b1742b5bd04a45">zb_bdb_finding_binding_initiator_cancel</a>.</li>
<li>Receive the <a class="el" href="group__zb__comm__signals.html#ga18f5e7ddfefb7d01ef98f696a9694d79">ZB_BDB_SIGNAL_FINDING_AND_BINDING_INITIATOR_FINISHED</a> signal that is generated in ZB_NWK_BROADCAST_DELIVERY_TIME = 9 seconds.</li>
<li>Repeat the procedure for every endpoint if needed.</li>
</ul>
</dd></dl>
<dl class="section user"><dt></dt><dd>On the target device:<ul>
<li>After the network steering completion, call <a class="el" href="group__zboss__bdb__comm__fb.html#gaacbca067e8c0f4349b15749e5bafd1cd">zb_bdb_finding_binding_target</a>, device shall respond the identify queries for <code>ZB_BDBC_MIN_COMMISSIONING_TIME_S</code> = 180 seconds.</li>
<li>When you need to cancel the procedure, call <a class="el" href="group__zboss__bdb__comm__fb.html#gac59426aadfc0c52014b1742b5bd04a45">zb_bdb_finding_binding_initiator_cancel</a>.</li>
<li>Receive the <a class="el" href="group__zb__comm__signals.html#gad0cef4db3c64ba67aef77c77ed79d7c3">ZB_BDB_SIGNAL_FINDING_AND_BINDING_TARGET_FINISHED</a> signal that is generated in <code>ZB_BDBC_MIN_COMMISSIONING_TIME_S</code> = 180 seconds.</li>
<li>Repeat the procedure for every endpoint if needed.</li>
</ul>
</dd></dl>
<dl class="section user"><dt>APIs</dt><dd>The following table shows an overview of the commissioning API. For details, see <a class="el" href="group__zboss__bdb__api.html">BDB commissioning API</a> in the <a class="el" href="group__api__zb.html">Zigbee stack API</a> documentation. <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Macro </th><th class="markdownTableHeadNone">Parameters </th><th class="markdownTableHeadNone">Return value </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__zboss__bdb__comm__start.html#ga0b54e93a19cadc5fc02df8eab18ecd45">bdb_start_top_level_commissioning(zb_uint8_t mode_mask)</a> </td><td class="markdownTableBodyNone"><code>zb_uint8_t</code> mode_mask &ndash; logical OR of values from <a class="el" href="group__zboss__bdb__comm__start.html#ga52e1f2781b2a066676130c2dd9df035f">zb_bdb_commissioning_mode_mask_t</a>. </td><td class="markdownTableBodyNone">ZB_TRUE &ndash; in case the device starts successfully <br  />
 ZB_FALSE &ndash; in case an error occured (for example: the device has already been running) </td><td class="markdownTableBodyNone">Initiate BDB commissioning procedure defined by the <code>mode_mask</code>.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group__zboss__bdb__comm__fb.html#gaacbca067e8c0f4349b15749e5bafd1cd">zb_bdb_finding_binding_target(zb_uint8_t endpoint)</a> </td><td class="markdownTableBodyNone"><code>zb_uint8_t</code> endpoint &ndash; endpoint to bind. </td><td class="markdownTableBodyNone">RET_OK if procedure was successfully started </td><td class="markdownTableBodyNone"><b>Finding and binding interface.</b><br  />
Set finding and binding target mode on the endpoint.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__zboss__bdb__comm__fb.html#gae6fd60a050559ef0aa3c3e5ec32bc515">zb_bdb_finding_binding_initiator(zb_uint8_t endpoint, zb_bdb_comm_binding_callback_t user_binding_cb)</a> </td><td class="markdownTableBodyNone"><code>zb_uint8_t</code> endpoint &ndash; endpoint to bind.<br  />
<code>user_binding_cb</code> - user callback function. </td><td class="markdownTableBodyNone">RET_OK, or the error code </td><td class="markdownTableBodyNone"><b>Finding and binding interface.</b><br  />
Initiate finding and binding on the endpoint. Pass result with <code>user_binding_cb</code>.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">typedef <a class="el" href="group__base__types.html#gac0098c2e9d8011bdc1ae2cd1d81c4598">zb_bool_t</a> (* <a class="el" href="group__zboss__bdb__comm__fb.html#ga19aecbc35df7a697da3e61180a3d27dc">zb_bdb_comm_binding_callback_t</a>)(<a class="el" href="group__base__types.html#gae69b8505e028941fe8e4417309babc00">zb_int16_t</a> status, <a class="el" href="group__base__types.html#ga18a7e5c477a2c48d021be71d173cf2b8">zb_ieee_addr_t</a> addr, <a class="el" href="group__base__types.html#gaa82a9657ef11a3947586065cf8066256">zb_uint8_t</a> ep, <a class="el" href="group__base__types.html#ga83793366ad4d54e8b65840d82a751498">zb_uint16_t</a> cluster) </td><td class="markdownTableBodyNone"><code>status</code> &ndash; status (ask user, success or fail).<br  />
<code>addr</code> &ndash; extended address of a device to bind<br  />
<code>ep</code> &ndash; endpoint of a device to bind.<br  />
<code>cluster</code> &ndash; cluster ID to bind. </td><td class="markdownTableBodyNone"><a class="el" href="group__base__types.html#gac0098c2e9d8011bdc1ae2cd1d81c4598">zb_bool_t</a> &ndash; agree or disagree to bind device. </td><td class="markdownTableBodyNone"><b>Finding and binding interface.</b><br  />
BDB finding and binding callback template.  </td></tr>
</table>
<center><b>Commissioning API calls</b></center> </dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section note"><dt>Note</dt><dd>Finding and binding (both target and initiator) must always be started explicitly.</dd></dl>
<h2><a class="anchor" id="reset_factory_defaults"></a>
Resetting to factory defaults</h2>
<p>The Zigbee stack provides an interactive mechanism to reset any node implementation to the default factory settings, based on the requirements in the official Zigbee BDB specification. There are the following approaches for this process:</p><ol type="1">
<li><a class="el" href="using_zigbee__z_c_l.html#reset_factory_defaults_ext">Resetting to factory defaults externally</a></li>
<li><a class="el" href="using_zigbee__z_c_l.html#reset_to_factory_defaults_via_local_action">Resetting to factory defaults with a local action</a></li>
</ol>
<p>The resetting process of a Zigbee-based application includes persistent data cleanup and consists of the following steps:</p><ol type="1">
<li>Optionally, inform the user about the reset to the factory settings.</li>
<li>Cancel any rejoin process if it is in progress. (The action is performed by the stack.)</li>
<li>Stop any pending send or resend callbacks; free the buffers that are locked for these operations.</li>
<li>Do one of the following:<ul>
<li>If the device supports OTA Upgrade process: stop this process by using <a class="el" href="group___z_b___z_c_l___o_t_a___u_p_g_r_a_d_e.html#ga1a22f3e7c367d447d68c5565e6c50cce">zcl_ota_abort()</a>.</li>
<li>If the device supports Poll Control cluster: stop the check-ins by using <a class="el" href="group___z_b___z_c_l___p_o_l_l___c_o_n_t_r_o_l.html#gaef6930c976acb8aa8e450c8e8d75ca30">zb_zcl_poll_control_stop()</a>.</li>
<li>If the device supports Power Config cluster: reset Power Config reporting to default.</li>
</ul>
</li>
<li>Reset attributes for each supported cluster.</li>
<li>Flush new attribute values to a persistent storage. <dl class="section note"><dt>Note</dt><dd>See <a class="el" href="group__zboss__nvram.html#ga6d495168cb1a9bb289f0558a0e28bcf0">zb_nvram_dataset_types_e</a> for dataset type list. Many datasets are written by the stack internally, but the following ones must be written by the application:<ul>
<li><a class="el" href="group__zboss__nvram.html#gga6d495168cb1a9bb289f0558a0e28bcf0ab5a81f28b45f76996003a535045b2d2b">ZB_NVRAM_HA_DATA</a></li>
<li><a class="el" href="group__zboss__nvram.html#gga6d495168cb1a9bb289f0558a0e28bcf0a4d61d004e6d23edf0533e23a21783e12">ZB_NVRAM_ZCL_REPORTING_DATA</a></li>
<li><a class="el" href="group__zboss__nvram.html#gga6d495168cb1a9bb289f0558a0e28bcf0a05b150c05a2927c2112c73a806af5b0b">ZB_NVRAM_HA_POLL_CONTROL_DATA</a> (use <a class="el" href="group___z_b___z_c_l___p_o_l_l___c_o_n_t_r_o_l.html#ga0b9444934469d786e60a48d1416cca60">zb_zcl_poll_control_save_nvram()</a>)</li>
</ul>
</dd></dl>
</li>
<li>Broadcast NWK leave.</li>
<li>At NWK leave confirmation:<ul>
<li>Optionally, inform the user about the completion of the factory reset process.</li>
<li>If needed, schedule device reboot.</li>
</ul>
</li>
<li>Free resources that were reserved by the application. <dl class="section note"><dt>Note</dt><dd>The application must not clean up the APS resources, for example in APS binding table, APS group table, and APS security keys storage. The stack performs the cleanup after the application sends the NWK Leave request to its own node.</dd></dl>
</li>
</ol>
<h3><a class="anchor" id="reset_factory_defaults_ext"></a>
Resetting to factory defaults externally</h3>
<p>The stack provides a feature to reset a device externally by sending <a class="el" href="group___z_b___z_c_l___b_a_s_i_c.html#ga777e02f18372fc1ec0f577625d048145">ZB_ZCL_BASIC_SEND_RESET_REQ</a>. The target device goes through all the steps mentioned above in <a class="el" href="using_zigbee__z_c_l.html#reset_factory_defaults">Resetting to factory defaults</a>. The reset can be performed at any time once the device is started (see <a class="el" href="using_zigbee__z_c_l.html#stack_start_initiation">Stack commissioning start sequence</a>). The device initiates either <a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#ga24886611b1f4427faa1a2cad668f335b">ZB_ZCL_SET_DEFAULT_VALUE_CB</a> in case it is predefined or the device user application callback with <a class="el" href="group___z_b___z_c_l___i_n_i_t_i_a_l_i_z_a_t_i_o_n.html#gga35caa2e3a9ef37535b1f75e0fe919266a918c694a3e7d3b6f6078995556f44bfb">ZB_ZCL_BASIC_RESET_CB_ID</a>.</p>
<h3><a class="anchor" id="reset_to_factory_defaults_via_local_action"></a>
Resetting to factory defaults with a local action</h3>
<p>The device can be reset to factory defaults with a local action. For instance, such a reset can be initiated by the device button press or internal application logics. To do this, use <a class="el" href="group__af__management__service.html#ga7c7c6a7b96b210641a8d9632e27ff4c8">zb_bdb_reset_via_local_action(zb_uint8_t param)</a>. The device performs NLME leave and cleans all Zigbee persistent data, except the outgoing NWK frame counter and application datasets (if any).</p>
<p>The application can reset its datasets before starting the process or after its completion. The reset can be performed at any time once the device is started (see <a class="el" href="using_zigbee__z_c_l.html#stack_start_initiation">Stack commissioning start sequence</a>).</p>
<p>After the reset, the application receives the <a class="el" href="group__zb__comm__signals.html#ga7942f336484c4fbb85626951480b2bba">ZB_ZDO_SIGNAL_LEAVE</a> signal that notifies the user about the completion of the reset procedure.</p>
<hr  />
<h1><a class="anchor" id="using_ZCL_security"></a>
Security</h1>
<p>The application has access to a selection of security measures in the stack. However, most options are invisible to the application, but the features provided by <a class="el" href="using_zigbee__z_c_l.html#security_nwk_security_api">Zigbee network security API</a> and <a class="el" href="using_zigbee__z_c_l.html#security_nwk_code_security_api">Zigbee API for code security installation</a> can be used to set up the necessary security measures.</p>
<h2><a class="anchor" id="security_nwk_security_api"></a>
Zigbee network security API</h2>
<p>Trust Center generates random network keys. This is the default behavior, according to <a href="https://www.zigbee.org/zigbee-for-developers/zigbee-pro/ " target="_blank">Zigbee PRO core specification</a>.</p>
<p>It is possible to predefine the network key by using <a class="el" href="group__secur__nwk__key.html#ga23f375eb4e96beebeb2f894d06723fdb">zb_secur_setup_nwk_key()</a>. You can use this API call for debugging purposes to simplify the analysis of traffic sniffing results. Do not use it in the production environment.</p>
<p>An application acting as a coordinator (Trust Center) can force the network key switch procedure by calling <a class="el" href="group__secur__nwk__key.html#ga23f375eb4e96beebeb2f894d06723fdb">zb_secur_setup_nwk_key()</a>.</p>
<h2><a class="anchor" id="security_nwk_code_security_api"></a>
Zigbee API for code security installation</h2>
<p>In accordance with the Zigbee 3.0 specifications, this SDK provides install code functionality. The following table provides an overview of the related API macros.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Macro </th><th class="markdownTableHeadNone">Parameters </th><th class="markdownTableHeadNone">Return value </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">void zb_secur_ic_add(zb_ieee_addr_t address, zb_uint8_t ic_type, zb_uint8_t *ic, zb_secur_ic_add_cb_t cb); </td><td class="markdownTableBodyNone"><code>zb_ieee_addr_t</code> address &ndash; long address of the device.<br  />
 <code>zb_uint8_t</code> ic_type - install code type as enumerated in <a class="el" href="group__secur__ic__usage.html#ga823dba3541c00dc1ce173d6db9f81657">zb_ic_types_t<br  />
</a> <code>zb_uint8_t</code> *ic &ndash; pointer to the install code buffer.<br  />
 <code>zb_secur_ic_add_cb_t</code> cb &ndash; callback that will be called after installcode addition. </td><td class="markdownTableBodyNone">Does not have return value. </td><td class="markdownTableBodyNone">Add the install code for the device with the specified long address. <b>Only for the coordinator.</b>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">zb_ret_t zb_secur_ic_set(zb_uint8_t ic_type, zb_uint8_t *ic); </td><td class="markdownTableBodyNone"><code>zb_uint8_t</code> ic_type - install code type as enumerated in <a class="el" href="group__secur__ic__usage.html#ga823dba3541c00dc1ce173d6db9f81657">zb_ic_types_t<br  />
</a> <code>zb_uint8_t</code> *ic &ndash; pointer to the install code buffer. </td><td class="markdownTableBodyNone"><code>zb_ret_t RET_OK</code> on success. <br  />
 <code>RET_CONVERSION_ERROR</code> on error in install code CRC. </td><td class="markdownTableBodyNone">Add the install code for a device. <b>Not for the coordinator.</b>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">void <a class="el" href="group__secur__ic__usage.html#ga2e6720904258049a768258fcf4831c95" title="Remove the install code for the device with specified long address. It is valid only for the TC (ZC).">zb_secur_ic_remove_req(zb_uint8_t param)</a>; </td><td class="markdownTableBodyNone"><code>zb_uint8_t</code> param &ndash; ID of the buffer with request parameters, it will be also used to store response. </td><td class="markdownTableBodyNone">Does not have return value. </td><td class="markdownTableBodyNone">Remove the install code for the device with the specified long address. <b>Only for the coordinator.</b>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">void <a class="el" href="group__secur__ic__usage.html#gabf719c00a29c7b6bbe756d49d622fad6">zb_set_installcode_policy(zb_bool_t allow_ic_only)</a>; </td><td class="markdownTableBodyNone"><code>zb_bool_t</code> allow_ic_only &ndash; If True, Install code is required for adding a new device to the network. If False, the default commisioning is used. </td><td class="markdownTableBodyNone">n/a </td><td class="markdownTableBodyNone">Set Install code policy flag.  </td></tr>
</table>
<center><b>Install code API calls</b></center> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="agroup___z_b___z_c_l___o_o_s_c_html_gaac509b1128c5a2fc9cc107f559466329"><div class="ttname"><a href="group___z_b___z_c_l___o_o_s_c.html#gaac509b1128c5a2fc9cc107f559466329">ZB_ZCL_ON_OFF_SWITCH_CONFIGURATION_SWITCH_ACTIONS_DEFAULT_VALUE</a></div><div class="ttdeci">#define ZB_ZCL_ON_OFF_SWITCH_CONFIGURATION_SWITCH_ACTIONS_DEFAULT_VALUE</div><div class="ttdoc">Default value for Switch actions attribute.</div><div class="ttdef"><b>Definition:</b> zb_zcl_on_off_switch_conf.h:116</div></div>
<div class="ttc" id="agroup__base__types_html_gaa82a9657ef11a3947586065cf8066256"><div class="ttname"><a href="group__base__types.html#gaa82a9657ef11a3947586065cf8066256">zb_uint8_t</a></div><div class="ttdeci">unsigned char zb_uint8_t</div><div class="ttdoc">Project-local 1-byte unsigned int type.</div><div class="ttdef"><b>Definition:</b> zb_types.h:147</div></div>
<div class="ttc" id="agroup___z_b___h_a___d_e_f_i_n_e___d_e_v_i_c_e___d_i_m_m_a_b_l_e___l_i_g_h_t_html_ga43db3ee88e06f7c79b73f9401561da43"><div class="ttname"><a href="group___z_b___h_a___d_e_f_i_n_e___d_e_v_i_c_e___d_i_m_m_a_b_l_e___l_i_g_h_t.html#ga43db3ee88e06f7c79b73f9401561da43">ZB_HA_DECLARE_DIMMABLE_LIGHT_EP</a></div><div class="ttdeci">#define ZB_HA_DECLARE_DIMMABLE_LIGHT_EP(ep_name, ep_id, cluster_list)</div><div class="ttdoc">Declare endpoint for Dimmable Light device.</div><div class="ttdef"><b>Definition:</b> zb_ha_dimmable_light.h:170</div></div>
<div class="ttc" id="agroup___z_b___z_c_l___o_o_s_c_html_ga005d9f73f4306d2327672c5fa992075b"><div class="ttname"><a href="group___z_b___z_c_l___o_o_s_c.html#ga005d9f73f4306d2327672c5fa992075b">ZB_ZCL_DECLARE_ON_OFF_SWITCH_CONFIGURATION_ATTRIB_LIST</a></div><div class="ttdeci">#define ZB_ZCL_DECLARE_ON_OFF_SWITCH_CONFIGURATION_ATTRIB_LIST(attr_list, switch_type, switch_actions)</div><div class="ttdoc">Declare attribute list for ON/OFF Switch configuration cluster.</div><div class="ttdef"><b>Definition:</b> zb_zcl_on_off_switch_conf.h:156</div></div>
<div class="ttc" id="astructzb__zcl__parsed__hdr__s_html"><div class="ttname"><a href="structzb__zcl__parsed__hdr__s.html">zb_zcl_parsed_hdr_s</a></div><div class="ttdef"><b>Definition:</b> zb_zcl_common.h:1156</div></div>
<div class="ttc" id="agroup__zb__comm__signals_html_ga03ab4c87fbcc7cf8e12bbfa9cb8a3be6"><div class="ttname"><a href="group__zb__comm__signals.html#ga03ab4c87fbcc7cf8e12bbfa9cb8a3be6">zb_get_app_signal</a></div><div class="ttdeci">zb_zdo_app_signal_type_t zb_get_app_signal(zb_uint8_t param, zb_zdo_app_signal_hdr_t **sg_p)</div><div class="ttdoc">Unpack application signal buffer in zboss_signal_handler()</div></div>
<div class="ttc" id="agroup__zb__general__main__loop_html_ga80765ed256180c6452ade57d4545b282"><div class="ttname"><a href="group__zb__general__main__loop.html#ga80765ed256180c6452ade57d4545b282">zboss_main_loop</a></div><div class="ttdeci">void zboss_main_loop(void)</div></div>
<div class="ttc" id="agroup__buf_html_gaf7e0718a3bb63059a2626ac98b54d65d"><div class="ttname"><a href="group__buf.html#gaf7e0718a3bb63059a2626ac98b54d65d">ZB_BUF_GET_PARAM</a></div><div class="ttdeci">#define ZB_BUF_GET_PARAM(buf, type)</div><div class="ttdef"><b>Definition:</b> zboss_api_buf.h:457</div></div>
<div class="ttc" id="agroup__zb__general__start_html_ga31b4d46033aaf6a400409d03bd40d392"><div class="ttname"><a href="group__zb__general__start.html#ga31b4d46033aaf6a400409d03bd40d392">zboss_start</a></div><div class="ttdeci">zb_ret_t zboss_start(void)</div><div class="ttdoc">ZBOSS start function.</div></div>
<div class="ttc" id="agroup__error__codes_html_ga76117585e8ddc62f21ca0e3061b7830e"><div class="ttname"><a href="group__error__codes.html#ga76117585e8ddc62f21ca0e3061b7830e">RET_OK</a></div><div class="ttdeci">#define RET_OK</div><div class="ttdoc">Error codes for non-void stack functions. In general, function can return OK, BLOCKED or some error....</div><div class="ttdef"><b>Definition:</b> zb_errors.h:79</div></div>
<div class="ttc" id="agroup___z_b___h_a___d_e_f_i_n_e___d_e_v_i_c_e___d_i_m_m_a_b_l_e___l_i_g_h_t_html_gab9021e9a2dd5ff2462d7b96bffd7dc5f"><div class="ttname"><a href="group___z_b___h_a___d_e_f_i_n_e___d_e_v_i_c_e___d_i_m_m_a_b_l_e___l_i_g_h_t.html#gab9021e9a2dd5ff2462d7b96bffd7dc5f">ZB_HA_DECLARE_DIMMABLE_LIGHT_CLUSTER_LIST</a></div><div class="ttdeci">#define ZB_HA_DECLARE_DIMMABLE_LIGHT_CLUSTER_LIST( cluster_list_name, basic_attr_list, identify_attr_list, groups_attr_list, scenes_attr_list, on_off_attr_list, level_control_attr_list)</div><div class="ttdoc">Declare cluster list for Dimmable Light device.</div><div class="ttdef"><b>Definition:</b> zb_ha_dimmable_light.h:77</div></div>
<div class="ttc" id="astructzb__zdo__app__signal__hdr__s_html"><div class="ttname"><a href="structzb__zdo__app__signal__hdr__s.html">zb_zdo_app_signal_hdr_s</a></div><div class="ttdef"><b>Definition:</b> zboss_api_zdo.h:1486</div></div>
<div class="ttc" id="agroup___z_b___z_c_l___o_o_s_c_html_ggae92bb00709be040ba03a01f754ea1f29aa3e98ff8bc1ba98068e1bd8204038039"><div class="ttname"><a href="group___z_b___z_c_l___o_o_s_c.html#ggae92bb00709be040ba03a01f754ea1f29aa3e98ff8bc1ba98068e1bd8204038039">ZB_ZCL_ON_OFF_SWITCH_CONFIGURATION_SWITCH_TYPE_TOGGLE</a></div><div class="ttdeci">@ ZB_ZCL_ON_OFF_SWITCH_CONFIGURATION_SWITCH_TYPE_TOGGLE</div><div class="ttdef"><b>Definition:</b> zb_zcl_on_off_switch_conf.h:71</div></div>
<div class="ttc" id="agroup__zb__general__main__loop_html_gab9f8bb77c5348ee1dea12ec1026517b1"><div class="ttname"><a href="group__zb__general__main__loop.html#gab9f8bb77c5348ee1dea12ec1026517b1">zboss_main_loop_iteration</a></div><div class="ttdeci">void zboss_main_loop_iteration(void)</div></div>
<div class="ttc" id="agroup__zb__comm__signals_html_gae05c0ff285cfd03e0997fe438e8047fc"><div class="ttname"><a href="group__zb__comm__signals.html#gae05c0ff285cfd03e0997fe438e8047fc">zboss_signal_handler</a></div><div class="ttdeci">void zboss_signal_handler(zb_uint8_t param)</div></div>
<div class="ttc" id="agroup__buf_html_ga72fb48e56b8e7f4b0cf12d12bd491b3b"><div class="ttname"><a href="group__buf.html#ga72fb48e56b8e7f4b0cf12d12bd491b3b">zb_bufid_t</a></div><div class="ttdeci">zb_uint8_t zb_bufid_t</div><div class="ttdef"><b>Definition:</b> zboss_api_buf.h:178</div></div>
<div id="nav-path" class="topicfooter">
<a href="mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback" id="maillink">Documentation feedback</a> | <a href="https://devzone.nordicsemi.com/questions/" target="_blank">Developer Zone</a> | <a href="http://response.nordicsemi.com/subscribe-to-our-newsletters" target="_blank">Subscribe</a> | Updated <span id="date"/>
<script>
var date = new Date("Thu Nov 14 2024" + " UTC");
document.getElementById("date").innerHTML = date.toJSON().slice(0, 10);
var url=window.location.href.split("?")[0];
var filename=url.substring(url.lastIndexOf('/')+1);
document.getElementById("maillink").href = "mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback"+decodeURIComponent("%26")+"body=File%20name%3A%20"+encodeURIComponent(filename);
</script>
</div>
</body>
</html>
